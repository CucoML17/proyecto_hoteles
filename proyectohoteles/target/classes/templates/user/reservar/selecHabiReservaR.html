<!DOCTYPE html>
<html lang="es" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${tituloLista}">Seleccionar Hotel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/indexcss.css}">
    <link rel="stylesheet" th:href="@{/css/indecssbody.css}">
    <link rel="stylesheet" th:href="@{/css/cssHoteles.css}">
</head>
<body>

    <div th:insert="user/fragment/headertop :: cabecera-top" class="top-navbar bg-black text-white py-2">
    </div>

    <nav th:insert="user/fragment/headerbottom :: cabecera-bottom" class="navbar navbar-expand-lg navbar-light bg-light sticky-top ">
    </nav>

    <div class="container mt-5 notop">
        <h2 class="text-center mb-4" th:text="${hotel.nombre}">Nombre del Hotel</h2>

        <div class="card mb-4 carddetah">
            <div class="row g-0">
                <div class="col-md-4 hotel-image">
                    <img th:src="@{'/imagenes/hoteles/' + ${hotel.fotoHotel}}" class="img-fluid rounded-start" alt="Imagen del Hotel">
                </div>
                <div class="col-md-8">
                    <div class="card-body">
                        <h5 class="card-title" th:text="${hotel.nombre}"></h5>
                        <hr>
                        <p class="card-text">Email: <span th:text="${hotel.email}"></span></p>
                        <hr>
                        <p class="card-text">Dirección: <span th:text="${hotel.direccion}"></span></p>
                        <hr>
                        <p class="card-text">Teléfonos:</p>
                        <ul class="list-unstyled">
                            <li th:each="telefono : ${hotel.telefonos}" th:text="${telefono.telefono}"></li>
                            <li th:if="${#lists.isEmpty(hotel.telefonos)}">No hay teléfonos registrados.</li>
                        </ul>
                        <hr>
                        <p class="card-text" th:text="'Precio promedio: $' + ${#numbers.formatDecimal(hotel.precioPromedio, 1, 2)}">Precio promedio: $100.00</p>
                    </div>
                </div>
            </div>
        </div>

        <h2 class="text-center mb-4">Habitaciones disponibles en <span th:text="${hotel.nombre}"></span></h2>
        
		<form  method="post" th:action="@{/user/reservar/buscarListaHabitaciones}">
			<input type="hidden" class="form-control" name="idReserva" th:value="${idReserva}">
            <input type="hidden" class="form-control me-2" placeholder="Número de habitación" name="idHotelPertenece" th:value="${hotel.id}">
            
            <div class="d-flex justify-content-center">
                <div style="max-width: 600px; width: 100%;">
                    <div class="mb-3 d-flex align-items-center">
                        <label class="form-label me-2">Número de habitación:</label>
                        <input type="number" class="form-control me-2" placeholder="Número de habitación" name="numeroHabitacion">
                    </div>
    
                    <div class="mb-3 d-flex align-items-center">
                        <label class="form-label me-2">Tipo de habitación:</label>
                        <select class="form-select" id="tipoHabitacionFilter" name="tipoHabitacion">
                            <option value="">Sin filtro</option>
                            <option value="Normal">Normal</option>
                            <option value="Doble">Doble</option>
                            <option value="Suite">Suite</option>
                        </select>
                    </div>
    
                    <div class="mb-3">
                        <label class="form-label">Filtrar por precio:</label>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="precioFilterCheckbox" name="filtrarPrecio">
                            <label class="form-check-label" for="precioFilterCheckbox">Activar filtro</label>
                        </div>
                        <div id="precioRange" style="display: none;">
                            <div class="d-flex align-items-center">
                                <input type="number" class="form-control me-2" placeholder="Min:" name="minPrecio">
                                <input type="number" class="form-control" placeholder="Max:" name="maxPrecio">
                            </div>
                        </div>
                    </div>
    
                    <div class="mb-3 d-flex align-items-center">
                        <label class="form-label me-2">Capacidad:</label>
                        <select class="form-select" id="capacidadFilter" name="capacidad">
                            <option value="">Sin filtro</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                        </select>
                    </div>
    
                    <div class="mb-3 d-flex align-items-center">
                        <label class="form-label me-2">Ordenar por:</label>
                        <select class="form-select me-2" name="ordenCampo">
                            <option value="">Sin ordenar</option>
                            <option value="numeroHabitacion">Número</option>
                            <option value="tipoHabitacion">Tipo</option>
                            <option value="precioNoche">Precio</option>
                            <option value="capacidad">Capacidad</option>
                        </select>
                        <select class="form-select" name="ordenDireccion">
                            <option value="asc">Ascendente</option>
                            <option value="desc">Descendente</option>
                        </select>
                    </div>
    
                    <button type="submit" class="btn btn-primary">Buscar</button>
                </div>
            </div>
    
            </form>         
        
        <div class="row mt-4">
            <th:block th:each="habitacion : ${listaHabitaciones}">
                <div class="col-md-6 mb-4">
                    <div class="card room-card">
                        <div class="row g-0">
                            <div class="col-md-4 room-image">
                                <img th:src="@{'/imagenes/habitaciones/' + ${habitacion.fotoHabitacion}}"
                                     class="img-fluid rounded-start h-100 object-fit-cover"
                                     alt="Imagen de la Habitación">
                            </div>
                            <div class="col-md-8">
                                <div class="card-body">
                                    <p class="card-text">Número de habitación: <span th:text="${habitacion.numeroHabitacion}"></span></p>
                                    <hr>
                                    <p class="card-text">Tipo de habitación: <span th:text="${habitacion.tipoHabitacion}"></span></p>
                                    <hr>
                                    <p class="card-text">Precio: $<span th:text="${#numbers.formatDecimal(habitacion.precioNoche, 1, 2)}"></span></p>
                                    <hr>
                                    <p class="card-text">Capacidad: <span th:text="${habitacion.capacidad}"></span></p>
                                    <hr>
                                    <a th:href="@{/user/reservar/abrirFormReserva/{idHabitacion}/{idReserva}(idHabitacion=${habitacion.id}, idReserva=${idReserva})}"
                                       class="btn btn-primary">Reservar</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div th:if="${(habitacionStat.index + 1) % 2 == 0}" class="w-100"></div>
            </th:block>
            <div th:if="${#lists.isEmpty(listaHabitaciones)}" class="col-12 text-center">
                <p>Este hotel no tiene habitaciones registradas.</p>
            </div>
        </div>
    </div>

    <footer class="bg-dark text-white text-center py-3 mt-5">
        <p>&copy; 2024 Cuco Corp. Todos los derechos reservados.</p>
    </footer>
    
    <script>
        window.addEventListener('scroll', function() {
            const navbarHeight = document.querySelector('.navbar').offsetHeight;
            document.querySelector('.admin-subheader').style.top = navbarHeight + 'px';
        });
    
        document.getElementById('precioFilterCheckbox').addEventListener('change', function() {
            document.getElementById('precioRange').style.display = this.checked ? 'block' : 'none';
        });
    
        document.getElementById('numeroHabitacionFilterCheckbox').addEventListener('change', function() {
            document.getElementById('numeroHabitacionFilterInput').style.display = this.checked ? 'block' : 'none';
        });
    </script>    

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
    <script src="https://kit.fontawesome.com/13c51e858e.js" crossorigin="anonymous"></script>
</body>
</html>